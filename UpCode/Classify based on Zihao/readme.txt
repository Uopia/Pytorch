Modifying on the basis of Zihao brother code